{% set price = product.calculatedPrice %}
{% if product.calculatedPrices|length > 0 %}
    {% set price = product.calculatedPrices.first() %}
{% endif %}

<div class="moorl-product-buy-list-item enable-add-to-cart{% if enableAddToCartAll %}-all{% endif %}{% if enableAddToCartSingle %}-single{% endif %}">
    {% if enableAddToCartAll %}
        <div class="custom-control custom-checkbox">
            <input type="checkbox"
                   class="custom-control-input"
                   name="productId[]"
                   value="{{ product.id }}"
                   id="product{{ product.id }}"
                   data-price="{{ price.unitPrice }}"
                   checked>
            <label class="custom-control-label" for="product{{ product.id }}"></label>
        </div>
    {% endif %}

    <div class="product-cover">
        {% if product.cover.media.url %}
            {% set attributes = {
                'alt': product.translated.name,
                'title': product.translated.name
            } %}
            {% sw_thumbnails 'product-image-thumbnails' with { media: product.cover.media } %}
        {% else %}
            {% sw_icon 'placeholder' style {'size': 'fluid'} %}
        {% endif %}
    </div>

    <div class="product-content">
        <div class="product-title">
            <a href="{{ seoUrl('frontend.detail.page', {'productId': product.id}) }}"
               data-toggle="modal"
               data-modal-class="quickview-modal"
               data-url="{{ path('widgets.quickview.minimal', { 'productId': product.id }) }}">
                {{ product.translated.name }}
            </a>
        </div>

        {% if product.parentId %}
            {% sw_include '@Storefront/plugin/moorl-foundation/component/product-buy-list/product-configurator.html.twig' %}
        {% endif %}

        {% if enablePrices %}
            <div class="products-buy-form-list-item-info-price">
                {{ price.unitPrice|currency }}{{ "general.star"|trans|sw_sanitize }}
            </div>
        {% endif %}
    </div>

    {% if enableAddToCartSingle %}
        <form action="{{ path('frontend.checkout.line-item.add') }}"
              method="post"
              data-add-to-cart="true"
              class="product-buy-form">
            {{ sw_csrf('frontend.checkout.line-item.add') }}
            <input type="hidden" name="lineItems[{{ product.id }}][id]" value="{{ product.id }}">
            <input type="hidden" name="lineItems[{{ product.id }}][type]" value="product">
            <input type="hidden" name="lineItems[{{ product.id }}][referencedId]" value="{{ product.id }}">
            <input type="hidden" name="lineItems[{{ product.id }}][stackable]" value="1">
            <input type="hidden" name="lineItems[{{ product.id }}][removable]" value="1">
            <input type="hidden" name="lineItems[{{ product.id }}][quantity]" value="1">
            <input type="hidden" name="redirectTo" value="frontend.cart.offcanvas">
            <button class="btn btn-light"
                    title="{{ "detail.addProduct"|trans|striptags }}"
                    aria-label="{{ "detail.addProduct"|trans|striptags }}">
                {% sw_icon 'plus' %}
            </button>
        </form>
    {% endif %}
</div>
