{% set options = {
    enablePrices: true,
    enableAddToCartAll: true,
    enableAddToCartSingle: true,
    enableSelection: true,
    currencyIso: context.currency.isoCode,
    discountValue: 0,
    addToCartSingleIcon: 'bag',
    addToCartAllIcon: 'bag'
}|merge(options) %}

{% set sumPrice = 0 %}
{% set sumDiscount = 0 %}

{% if cart.lineItems.count > 0 %}
    <form
            action="{{ path('frontend.checkout.line-item.add') }}"
            method="post"
            data-add-to-cart="true"
            class="moorl-parts-list"
            data-moorl-parts-list
            data-moorl-parts-list-options='{{ options|json_encode|raw }}'
    >
        <input type="hidden" name="redirectTo" value="frontend.cart.offcanvas">

        <ul class="moorl-parts-list-items">
            <li class="moorl-parts-list-item">
                <div></div>
                <div>{{ "moorl-foundation.properties.quantity"|trans }}</div>
                <div>{{ "moorl-foundation.properties.product"|trans }}</div>
                <div class="text-end">{{ "moorl-foundation.properties.subtotal"|trans }}</div>
            </li>
            {% for lineItem in cart.lineItems %}
                {% if lineItem.type == 'product' %}
                    {% sw_include '@MoorlFoundation/plugin/moorl-foundation/component/proxy-cart/product-item.html.twig' %}

                    {% set sumPrice = sumPrice + lineItem.price.totalPrice %}
                {% endif %}

                {% if lineItem.type == 'promotion' %}
                    {% set sumDiscount = sumDiscount + lineItem.price.totalPrice %}
                {% endif %}
            {% endfor %}

            <li class="">
                <div class="text-end">{{ (sumPrice)|currency }}{{ "general.star"|trans|sw_sanitize }}</div>
            </li>
            <li class="">
                <div class="text-end">{{ (sumDiscount)|currency }}{{ "general.star"|trans|sw_sanitize }}</div>
            </li>
            <li class="">
                <div class="text-end">{{ (cart.price.totalPrice)|currency }}{{ "general.star"|trans|sw_sanitize }}</div>
            </li>
        </ul>

        {% if options.enableAddToCartAll %}
            <div class="d-grid">
                <button
                        data-moorl-product-buy-list-button
                        class="btn btn-primary btn-buy"
                        title="{{ "detail.addProduct"|trans|striptags }}"
                        aria-label="{{ "detail.addProduct"|trans|striptags }}"
                >
                    {% sw_icon 'icon' style {fileName: options.addToCartAllIcon} %}
                    {{ "detail.addProduct"|trans|striptags }}
                </button>
            </div>
        {% endif %}
    </form>
{% elseif options.emptyText and config('MoorlFoundation.config.cmsEmptyAlert') %}
    {% sw_include "@Storefront/storefront/utilities/alert.html.twig" with {
        type: "primary",
        content: options.emptyText ?: "moorl-foundation.search.notAvailable"|trans
    } %}
{% endif %}
