<sw-page :class="identifier">
    <template #search-bar>
        <sw-search-bar
                :initial-search-type="entity"
                :initial-search="term"
                @search="onSearch"
        />
    </template>

    <template #smart-bar-actions>
        <mt-button
                v-if="!indexPage"
                variant="primary"
                size="default"
                @click="onCreateItem"
        >
            {{ $tc('global.default.add') }}
        </mt-button>

        <moorl-demo-button
                v-if="pluginName"
                :pluginName="pluginName"
                :name="demoName"
                @on-finish="getList"
        />
    </template>

    <template #language-switch>
        <sw-language-switch @on-change="onChangeLanguage"/>
    </template>

    <template #sidebar>
        <sw-sidebar>
            <sw-sidebar-item
                    icon="regular-redo"
                    :title="$tc('moorl-foundation.buttons.refreshButtonText')"
                    @click="getList"
            />

            <sw-sidebar-item
                    icon="regular-cloud-upload"
                    :title="$tc('moorl-foundation.buttons.importButtonText')"
                    @click="onImportModal"
            />

            <sw-sidebar-item
                    icon="regular-cloud-download"
                    :title="$tc('moorl-foundation.buttons.exportButtonText')"
                    @click="onExportModal"
            />
        </sw-sidebar>
    </template>

    <template #content>
        <sw-entity-listing
                v-if="entitySearchable"
                :identifier="identifier"
                :detailRoute="getItemRoute('detail')"
                :items="items"
                :repository="itemRepository"
                :showSelection="true"
                :columns="columns"
                :is-loading="isLoading"
                :criteria-limit="limit"
                :sort-by="sortBy"
                :sort-direction="sortDirection"
                :disable-data-fetching="true"
                @select-item="updateSelection"
                @page-change="onPageChange"
                @column-sort="onSortColumn"
                @update-records="updateTotal"
        >
            <template #preview-name="{ item }">
                <sw-media-preview-v2
                        v-if="mediaProperty"
                        :source="item[mediaProperty]"
                />
            </template>

            <template #column-date="{ item }">
                {{ dateFilter(item.date, { hour: '2-digit', minute: '2-digit' }) }}
            </template>

            <template #column-showFrom="{ item }">
                {{ dateFilter(item.showFrom, { hour: '2-digit', minute: '2-digit' }) }}
            </template>

            <template #column-showUntil="{ item }">
                {{ dateFilter(item.showUntil, { hour: '2-digit', minute: '2-digit' }) }}
            </template>

            <template #more-actions="{ item }">
                <sw-context-menu-item @click="onDuplicate(item)">
                    {{ $tc('sw-product.list.buttonDuplicate') }}
                </sw-context-menu-item>
            </template>
        </sw-entity-listing>

        <moorl-csv-import
                v-if="showImportModal"
                :entity="entity"
                :onCloseModal="onCloseModal"
                :onFinishImport="getList"
        />

        <moorl-csv-export
                v-if="showExportModal"
                :entity="entity"
                :onCloseModal="onCloseModal"
                :selectedItems="selection"
        />
    </template>
</sw-page>
